#!/usr/bin/python
import readspec
import argparse
import parser
from util import *
from model import *
from ectlconv import *
import logging

# Parse command line arguments
# ddctl.py -s <specfile.json> -m <cli | gui>

argparser = argparse.ArgumentParser(description='Parse a CTL formula')
argparser.add_argument('-s', '--specfile', help='specfile.json', required=True)
args = argparser.parse_args()

ks, ctlf = readspec.read_spec(args.specfile)

isectl, ectlf = ECTLConverter().ectl(parser.parse(ctlf))

# if not isectl:
#     logging.error("CTL formula + '%s' is not ECTL" % ectlf.body)
#     exit(1)

print(ectlf.body)

ksbdd = ksBDD(ks)

m = Model(ks, ectlf)

result = m.check()
print(reduce(mergecur, ksbdd.infer(result))) # test inference

# if m.check() == False:
#     print("Counterexample: ", m.counterexample)
# else:
#     print("The CTL formula is valid")

